schema: '2.0'
stages:
  install:
    cmd: poetry install
  check_env:
    cmd: python src/utils/load_env.py
    deps:
    - path: .env
      hash: md5
      md5: 89c06c2b5468b6e9d6d9b01799ffeab9
      size: 147
  load_env:
    cmd: python src/utils/load_env.py
    deps:
    - path: .env
      hash: md5
      md5: 92d96330b0e0b8941ac456460713942b
      size: 202
  data_download:
    cmd: python src/modules/data_download/data_download.py
    deps:
    - path: data/basemap-metadata/basemap-metadata.json
      hash: md5
      md5: 8a465e42c9c492ba6f4affd6af3698a6
      size: 469
    - path: data/surveys/gcro-2016.dta
      hash: md5
      md5: b18fed022c1ad5c6588391a14ce4acac
      size: 239054964
    - path: data/surveys/gcro-2018.dta
      hash: md5
      md5: 74f9efb62a3992e2e5edd220afbbee79
      size: 17658506
    - path: data/surveys/gcro-2021.dta
      hash: md5
      md5: 3af38f13b58e0bb17be0cf1911b828b4
      size: 8499821
    - path: src/modules/data_download/data_download.py
      hash: md5
      md5: 4346f6796e342b36df0cb73b6688bc55
      size: 1596
  preprocess:
    cmd: python src/modules/preprocessing/preprocess.py
    deps:
    - path: src/modules/preprocessing/preprocess.py
      hash: md5
      md5: da3b21a060f5f6a7aa858ac55308515e
      size: 123
  train:
    cmd: python src/modules/training/train.py
    deps:
    - path: src/modules/training/train.py
      hash: md5
      md5: 967ddcb9997bc563e883c55db1eff489
      size: 118
  evaluate:
    cmd: python src/modules/evaluation/evaluate.py outputs/model.pkl data/intermediate
    deps:
    - path: src/modules/evaluation/evaluate.py
      hash: md5
      md5: 9cc3e729d5672039b8da235b0f9ab870
      size: 118
  shapefile_processing:
    cmd: python src/modules/shapefile_processing/shapefile_process.py
    deps:
    - path: data/shapefiles/2011
      hash: md5
      md5: bdf63d65f51b6f4b0e8fe805d3776cb3.dir
      size: 115252968
      nfiles: 6
    - path: data/shapefiles/2016
      hash: md5
      md5: e506ece68c603f5f346a71419331b389.dir
      size: 60780086
      nfiles: 6
    - path: data/shapefiles/2020
      hash: md5
      md5: f0103491ddab83e03dcdf3e4d4013efc.dir
      size: 60269229
      nfiles: 6
    - path: src/modules/shapefile_processing/shapefile_process.py
      hash: md5
      md5: 00320e8df8aa1c4f4aa37d75d8bffa35
      size: 2251
    outs:
    - path: outputs/processed-shapefile/gauteng-boundary-unprocessed.geojson
      hash: md5
      md5: 9fe82c51ba5cb2c39e8be8e0703822b9
      size: 242617
    - path: outputs/processed-shapefile/gauteng-boundary-unprocessed.png
      hash: md5
      md5: f825e045948567c2bbb028dc31ba39eb
      size: 34101
    - path: outputs/processed-shapefile/gauteng-boundary.geojson
      hash: md5
      md5: 7f7dd407b7d8f29c83d9cf0ba7d6f4f2
      size: 691662
    - path: outputs/processed-shapefile/gauteng-boundary.png
      hash: md5
      md5: 93860f3618c778f7f618e68d3aaec889
      size: 34113
    - path: outputs/processed-shapefile/gauteng-wards.geojson
      hash: md5
      md5: c87921e9eea50dc5f5cd0d0d0042f05d
      size: 5370316
    - path: outputs/processed-shapefile/gauteng-wards.png
      hash: md5
      md5: 9f4dc17babf4e4f0fa961810dc40365b
      size: 65880
  gcro_processing:
    cmd: python src/modules/gcro_processing/gcro_process.py
    deps:
    - path: data/surveys/gcro-2016.dta
      hash: md5
      md5: b18fed022c1ad5c6588391a14ce4acac
      size: 239054964
    - path: data/surveys/gcro-2018.dta
      hash: md5
      md5: 74f9efb62a3992e2e5edd220afbbee79
      size: 17658506
    - path: data/surveys/gcro-2021.dta
      hash: md5
      md5: 3af38f13b58e0bb17be0cf1911b828b4
      size: 8499821
    - path: src/modules/gcro_processing/gcro_process.py
      hash: md5
      md5: 2e07910790d67849dc981a0900c6108a
      size: 2408
    outs:
    - path: outputs/processed-gcro/gcro-clustered-data.csv
      hash: md5
      md5: fd14932c47c6c5032a35f361eb917b09
      size: 83318
    - path: outputs/processed-gcro/gcro-column-datatypes.json
      hash: md5
      md5: 639dacf242b430f397437fde557da6d5
      size: 8646
    - path: outputs/processed-gcro/gcro-date-info.json
      hash: md5
      md5: fe466fbd7f52211d9b3fe35da926acdd
      size: 106
  gcro_shapefile_merge:
    cmd: python src/modules/gcro_shapefile_merge/gcro_shapefile_merge.py
    deps:
    - path: outputs/processed-gcro/gcro-clustered-data.csv
      hash: md5
      md5: fd14932c47c6c5032a35f361eb917b09
      size: 83318
    - path: outputs/processed-shapefile/gauteng-wards.geojson
      hash: md5
      md5: c87921e9eea50dc5f5cd0d0d0042f05d
      size: 5370316
    - path: src/modules/gcro_shapefile_merge/gcro_shapefile_merge.py
      hash: md5
      md5: 9b7bc079f113878147cbfa07ddfbd7f6
      size: 1511
    outs:
    - path: outputs/merged/gauteng-qol.geojson
      hash: md5
      md5: 1b0638102484489c12746c8501691ee1
      size: 5389380
    - path: outputs/merged/gauteng-qol.png
      hash: md5
      md5: b7c6c18c61f4083223600a76d48ab886
      size: 78817
  generate_grid:
    cmd: python src/modules/grid_generation/generate_grid.py
    deps:
    - path: outputs/merged/gauteng-qol.geojson
      hash: md5
      md5: 1b0638102484489c12746c8501691ee1
      size: 5389380
    - path: src/modules/grid_generation/generate_grid.py
      hash: md5
      md5: cbfa27d7e77f59eed331be5805456d71
      size: 2982
    outs:
    - path: outputs/grid/grid-gauteng-qol.png
      hash: md5
      md5: bafa000296f0440389105a5b7b646b0a
      size: 742254
    - path: outputs/grid/grid-overlay.png
      hash: md5
      md5: c89487f3c07b91ec61bf9edc0adce8a8
      size: 770593
    - path: outputs/grid/qol-labelled-grid.csv
      hash: md5
      md5: 25c42a83bfac2ac857d0efbfdbcaca94
      size: 4100978
  mosaiks_prediction:
    cmd: python src/modules/mosaiks_prediction/predict.py
    deps:
    - path: data/mosaiks-features/mosaiks_features.csv
      hash: md5
      md5: 3d33d043b5f9052405a5744a24ea7581
      size: 1261596796
    - path: outputs/grid/qol-labelled-grid.csv
      hash: md5
      md5: dd338aecc08f7019d4796627277ff554
      size: 4094302
    - path: src/modules/mosaiks_prediction/predict.py
      hash: md5
      md5: 050dee06d43e908b77831b82ff7ed571
      size: 1544
